<!doctype html>
<html lang="nl">
  <head>
    <meta charset="utf-8" />
    <title>Jayco Admin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Extra info voor Decap, mag blijven staan -->
    <link href="/admin/config.yml" type="text/yaml" rel="cms-config-url" />

    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        margin: 0;
        padding: 0;
        background: #f5f5f7;
      }

      .header {
        padding: 16px 24px;
        background: #111827;
        color: #ffffff;
      }

      .header-title {
        font-size: 1.4rem;
        font-weight: 600;
      }

      .header-sub {
        font-size: 0.9rem;
        opacity: 0.8;
        margin-top: 4px;
      }
    </style>
  </head>

  <body>
    <div class="header">
      <div>
        <div class="header-title">Jayco Research Tool – Admin</div>
        <div class="header-sub">
          Beheer standaardteksten, landenrisico’s, sectorrisico’s, enz.
        </div>
      </div>
    </div>

    <!-- Netlify Identity widget -->
    <div data-netlify-identity-widget></div>

    <!-- Netlify Identity script -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

    <!-- Decap CMS (voorheen Netlify CMS) -->
    <script src="https://unpkg.com/decap-cms-app@^3.1.2/dist/decap-cms-app.js"></script>

    <script>
      // Dwing Decap om /admin/config.yml te gebruiken
      window.CMS_MANUAL_INIT = true;

      window.addEventListener("load", function () {
        CMS.init({
          config: {
            load_config_file: true,
            config_path: "/admin/config.yml",
          },
        });

        // Optioneel: redirect na login via Netlify Identity
        if (window.netlifyIdentity) {
          window.netlifyIdentity.on("init", (user) => {
            if (!user) {
              window.netlifyIdentity.on("login", () => {
                document.location.href = "/admin/";
              });
            }
          });
        }
      });
    </script>
  </body>
</html>
